<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Double Wilson Prior Calculations in careless &mdash; careless</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/rs-favicon_32x32.png"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=a5a11c44"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Other utilites" href="stats.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            careless
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="careless.html">careless CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="stats.html">Other utilites</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The &quot;Double Wilson&quot; algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#wilsons-priors">Wilson’s priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#joint-priors">Joint priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#acentric-joint-priors">Acentric joint priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#centric-joint-priors">Centric joint priors</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">careless</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Double Wilson Prior Calculations in <code class="docutils literal notranslate"><span class="pre">careless</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/double_wilson.md" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="double-wilson-prior-calculations-in-careless">
<h1>Double Wilson Prior Calculations in <code class="docutils literal notranslate"><span class="pre">careless</span></code><a class="headerlink" href="#double-wilson-prior-calculations-in-careless" title="Link to this heading"></a></h1>
<p>This page briefly describes the so-called “Double Wilson” distributions available for use in <code class="docutils literal notranslate"><span class="pre">careless</span></code> when using one dataset as a reference for another.</p>
<p>We’d like to be able to make priors in which certain sets of structure factors are conditional on others. The conditional distributions for structure factors are the Rice and Woolfson (Folded Normal) distributions for acentrics and centrics respectively.</p>
<section id="wilsons-priors">
<h2>Wilson’s priors<a class="headerlink" href="#wilsons-priors" title="Link to this heading"></a></h2>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\mathcal{W}ilson(F_h | \epsilon_h, \Sigma) = \begin{cases} 
    \mathcal{H}alfnormal\left(F_h|\epsilon_h \Sigma \right) = \sqrt{\frac{2}{\pi\epsilon_h\Sigma}} \exp\left(-\frac{F^2_h}{2\epsilon_h\Sigma}\right)  &amp; h \in centrics \\
    \mathcal{R}ayleigh\left(F_h| \epsilon_h \Sigma \right) = \frac{2}{\epsilon_h\Sigma} F_h \exp\left(-\frac{F^2_h}{\epsilon_h\Sigma}\right) &amp; h \in acentrics \\
\end{cases}
\end{equation*}\]</div>
</section>
<section id="joint-priors">
<h2>Joint priors<a class="headerlink" href="#joint-priors" title="Link to this heading"></a></h2>
<p>For two structure factors, <span class="math notranslate nohighlight">\(G_h\)</span> and <span class="math notranslate nohighlight">\(F_h\)</span>, let</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
    z_f &amp;\sim F_h \\
    z_g &amp;\sim G_h \\
\end{align*}\]</div>
<p>denote reparameterized samples.
The joint probability factorizes as,
$<span class="math notranslate nohighlight">\(P(F_h, G_h) = P(G_h | F_h) P(F_h).\)</span><span class="math notranslate nohighlight">\( 
\)</span>F_h<span class="math notranslate nohighlight">\( follows Wilson's prior, 
\)</span><span class="math notranslate nohighlight">\(P(F_h) = \mathcal{W}ilson(\epsilon_h, \Sigma),\)</span>$</p>
</section>
<section id="acentric-joint-priors">
<h2>Acentric joint priors<a class="headerlink" href="#acentric-joint-priors" title="Link to this heading"></a></h2>
<p>The joint probability of the samples is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
P(z_f, z_g| r, \Sigma, \epsilon_h) &amp;= \mathcal{R}ice\left(z_g \big\vert r z_f, \sqrt{\frac{\epsilon_h \Sigma }{2}\left(1 - r^2\right)}\right) 
\mathcal{W}ilson\left(z_f|\epsilon_h, \Sigma \right),\\
\end{align*}\]</div>
<p>Where the conditional is a Rice distribution,
$<span class="math notranslate nohighlight">\(
Rice(x | \nu, \sigma) = \frac{x}{\sigma^2} \exp\left(\frac{-(x^2+\nu^2)}{2\sigma^2}\right)I_0\left(\frac{x\nu}{\sigma^2}\right)
\)</span>$</p>
</section>
<section id="centric-joint-priors">
<h2>Centric joint priors<a class="headerlink" href="#centric-joint-priors" title="Link to this heading"></a></h2>
<p>The joint probability of the samples is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
P(z_f, z_g| r, \Sigma, \epsilon_h) &amp;= \mathcal{F}oldednormal\left(z_g \big\vert r z_f, \sqrt{\epsilon_h \Sigma \left(1 - r^2\right)}\right) 
\mathcal{W}ilson\left(z_f|\epsilon_h, \Sigma \right),
\end{align*}\]</div>
<p>Where the conditional is a folded normal distribution,
$<span class="math notranslate nohighlight">\(
FoldedNormal(x | \mu, \sigma) = \frac{1}{\sigma\sqrt{2\pi}}\exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right) + \frac{1}{\sigma\sqrt{2\pi}}\exp\left(-\frac{(x+\mu)^2}{2\sigma^2}\right)
\)</span>$</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="stats.html" class="btn btn-neutral float-left" title="Other utilites" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Kevin M. Dalton.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>